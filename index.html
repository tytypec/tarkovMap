<!DOCTYPE html>
<html>
    <head>
        <style>
            body{
                margin-left: 0px;
                width: 1920px;
                height: 998px;
            }
            #mainContainer{
                width: 1920px;
                height: 998px;
                position: absolute;
            
            }
            img{
                max-width: 100%;
                max-width: 100%
            }

            #myCanvas{
            position: absolute;
            }
            button{
                margin-top: 50px;
            }
        </style>
    </head>

    <body>
        <div id="mainContainer">
                <canvas id="myCanvas" width=1920 height=998 style="cursor:crosshair"></canvas>
                <img src="\images\customsMap.PNG" alt="The map didn't load">
                
            <button onclick="reset()">Reset</button>
        </div>
    

        <script>
        
            var yellowValue = 222;
            var heatSize = 40;
            var mapArea = document.getElementById('myCanvas');
            var context = mapArea.getContext('2d');
            

            function reset(){
                if (confirm('Are you sure you want to reset your map?')) {
                    localStorage.clear();
                    console.log("you clicked reset")
                    window.location.reload();
                } else {

                }

            }

        
            if(localStorage.getItem('textValues') == null){
            var locations=[];
            }
            else{
            locations =  JSON.parse(localStorage.getItem('textValues'));
            deathLocation("initialLoad");
            }


            
            
            function storeCooridnate(xValue, yValue, array, color, size){
                array.push({xValue, yValue, color, size});
                localStorage.setItem('textValues', JSON.stringify(array));
            }

                
            function printMousePos(event, canvas) {
                const rectangle = mapArea.getBoundingClientRect();
                storeCooridnate(event.clientX - rectangle.left, event.clientY - rectangle.top, locations, yellowValue, heatSize);
                console.log(locations);
                deathLocation("normal");
            }

            function deathLocation(type){



                    if (type === "initialLoad"){
                        locations.forEach(function(item,j){
                            var colorHolder = 'rgba(245, ' + locations[j].color + ', 0, 0.2)'
                            context.beginPath();
                            context.arc(locations[j].xValue, locations[j].yValue, locations[j].size, 0, 2 * Math.PI);
                            context.fillStyle = colorHolder;
                            context.stroke();
                            context.fill();
                        }
                    )
                    } 
                    else {
                        colorShift()
                        var colorHolder = 'rgba(245, ' + yellowValue + ', 0, 0.2)'
                        //context.fillText("x",locations[locations.length - 1].xValue, locations[locations.length - 1].yValue);
                        //context.font = "bold 30px Arial";
                        context.beginPath();
                        context.arc(locations[locations.length - 1].xValue, locations[locations.length - 1].yValue, heatSize, 0, 2 * Math.PI);
                        context.fillStyle = colorHolder;
                        context.stroke();
                        context.fill();
                    }
            }

            function colorShift(){
                    locations.forEach(function(item,i) {
                    let heatSensitivity = 100
                    let minimumXValue = (locations[i].xValue - heatSensitivity)
                    let maximumXValue = (locations[i].xValue + heatSensitivity)
                    let minimumYValue = (locations[i].yValue - heatSensitivity)
                    let maximumYValue = (locations[i].yValue + heatSensitivity)

                    function between(comparedNumber,min,max){
                    // console.log("here",comparedNumber, min, max);
                        return ((comparedNumber-min)*(comparedNumber-max) <= 0);   
                        //return comparedNumber >= min && comparedNumber <= max;
                        
                    }
                    //console.log(between(locations[locations.length - 1].xValue, minimumXValue, maximumXValue));
                        if (between(locations[locations.length - 1].xValue, minimumXValue, maximumXValue) && between(locations[locations.length - 1].yValue, minimumYValue, maximumYValue)){
                            //console.log(locations[locations.length - 1].xValue);
                            yellowValue = yellowValue - 60;
                            heatSize = heatSize + 4;
                        //console.log("inside function ", yellowValue);
                            return yellowValue;
                        } 
                        else {
                            yellowValue = 222;
                            heatSize = 40;
                        }
                    
                    });

            }

            myCanvas.addEventListener("click", printMousePos);

        </script>
    </body>
</html>